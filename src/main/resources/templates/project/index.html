<!DOCTYPE html>
<html lang="ko">
<head th:replace="~{layout/fragments :: common-meta}">
    <title>프로젝트 관리</title>
</head>
<body>

<th:block th:replace="~{layout/fragments :: common-header('프로젝트 관리', '프로젝트 관리')}"></th:block>

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>프로젝트 목록</h2>
        <button class="btn btn-primary" id="new-project">
            <i class="fas fa-plus"></i> 새 프로젝트
        </button>
    </div>

    <div class="card">
        <div class="card-body" id="projectList">
            <!-- 프로젝트가 있는 경우 -->
            <div th:if="${PROJECTS != null and !PROJECTS.isEmpty()}">
                <div th:each="project : ${PROJECTS}" class="project-card clickable">

                    <!-- 삭제 버튼을 카드 우상단에 고정 -->
                    <div class="project-delete-btn" onclick="event.stopPropagation()">
                        <button class="btn-delete" id="delete-project" th:data-project-idx="${project.idx}">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <div class="project-main project-clickable" th:onclick="|location.href='/project/${project.idx}'|">
                        <div class="project-header">
                            <div class="project-info">
                                <div class="project-title" th:text="${project.title}">프로젝트 제목</div>
                                <div class="project-meta">
                                    <span class="project-version" th:text="'v' + ${project.version}">v1.0.0</span>
                                    <span class="project-date" th:text="'생성일: ' + ${#temporals.format(project.createdAt, 'yyyy-MM-dd')}">생성일: 2024-12-15</span>
                                </div>
                            </div>

                            <div class="project-stats">
                                <div class="stat-item" th:if="${project.docsCount != null and project.docsCount > 0}">
                                    <div class="stat-icon docs">
                                        <i class="fas fa-file-code"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-number" th:text="${project.docsCount}">3</div>
                                        <div class="stat-label">API 문서</div>
                                    </div>
                                </div>

                                <div class="stat-item" th:if="${project.flowsCount != null and project.flowsCount > 0}">
                                    <div class="stat-icon flows">
                                        <i class="fas fa-project-diagram"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-number" th:text="${project.flowsCount}">2</div>
                                        <div class="stat-label">API Flow</div>
                                    </div>
                                </div>

                                <!-- 산출물이 없는 경우 -->
                                <div class="empty-stats"
                                     th:if="${(project.docsCount == null or project.docsCount == 0) and (project.flowsCount == null or project.flowsCount == 0)}">
                                    <div class="empty-icon">
                                        <i class="fas fa-plus-circle"></i>
                                    </div>
                                    <div class="empty-text">산출물을 추가해보세요</div>
                                </div>
                            </div>
                        </div>

                        <div class="project-description" th:if="${project.description}">
                            <p th:text="${project.description}">프로젝트 설명</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 프로젝트가 없는 경우 -->
            <div th:if="${PROJECTS == null or PROJECTS.isEmpty()}" class="empty-state">
                <i class="fas fa-folder-open"></i>
                <p>아직 생성된 프로젝트가 없습니다.</p>
                <button class="btn btn-primary mt-3" id="new-project">
                    <i class="fas fa-plus"></i> 첫 번째 프로젝트 만들기
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 기본 모달 -->
<th:block th:replace="~{layout/fragments :: common-modal}"></th:block>
<!-- 필수 JS -->
<th:block th:replace="~{layout/fragments :: essential-js}"></th:block>
<script th:src="@{/js/pages/project/index.js}"></script>
</body>
</html>
